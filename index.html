<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>הטיול הארקטי שלנו | טרומסו 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Grounded & Calm -->
    <!-- Application Structure Plan: Mobile-First Scrollable Tabs SPA -->
    
    <style>
        body {
            font-family: 'Assistant', sans-serif;
            direction: rtl;
            background-color: #F5F0E6;
            color: #4D453E;
            -webkit-tap-highlight-color: transparent; /* הסרת הבהוב בלחיצה במובייל */
        }

        /* הסתרת פס גלילה בתפריט הניווט אך שמירה על יכולת גלילה */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }
        .tab-content.active {
            display: block;
        }

        .nav-link {
            white-space: nowrap; /* מונע שבירת שורות בכפתורים */
            flex-shrink: 0;      /* מונע כיווץ כפתורים */
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            opacity: 0.7;
        }
        .nav-link.active {
            border-bottom-color: #4D453E;
            color: #4D453E;
            font-weight: 700;
            opacity: 1;
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 300px; /* גובה קבוע למובייל */
            margin: 1rem auto;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px; /* גובה לדסקטופ */
                max-width: 500px;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .checklist-item {
            transition: background-color 0.2s;
        }
        .checklist-item:active {
            background-color: rgba(0,0,0,0.05);
        }
        .checklist-item:has(input:checked) span {
            text-decoration: line-through;
            color: #8A7F77;
            opacity: 0.7;
        }
        
        /* סגנונות מסך כניסה */
        #login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100dvh; /* שימוש ב-dvh למובייל */
            background-color: #F5F0E6;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }
        .login-box {
            background: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 30px rgba(77, 69, 62, 0.15);
            text-align: center;
            width: 100%;
            max-width: 320px;
        }
        
        /* סגנון הודעת שגיאה (Overlay) */
        #error-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(77, 69, 62, 0.6); 
            backdrop-filter: blur(2px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        .error-box {
            background: white;
            padding: 2rem;
            border-radius: 1.5rem;
            text-align: center;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 280px;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-[#F5F0E6] min-h-screen pb-safe">

    <!-- מסך כניסה -->
    <div id="login-screen">
        <div class="login-box">
            <div class="text-4xl mb-2">🏔️</div>
            <h2 class="text-2xl font-bold text-[#4D453E] mb-2">הטיול לטרומסו</h2>
            <p class="text-[#8A7F77] text-sm mb-6">לצפייה בתוכנית הטיול</p>
            
            <input type="password" id="passcode-input" placeholder="הזן קוד" inputmode="numeric" pattern="[0-9]*" maxlength="4" 
                   class="w-full text-center text-2xl p-4 border-2 border-[#D8CFC7] rounded-xl focus:outline-none focus:border-[#4D453E] focus:ring-1 focus:ring-[#4D453E] mb-4 tracking-widest bg-[#FAFAFA]">
            
            <button id="login-btn" class="w-full bg-[#4D453E] text-white font-bold text-lg py-4 rounded-xl hover:bg-[#3a342f] active:scale-95 transition-all shadow-lg shadow-[#4D453E]/20">
                כניסה למערכת
            </button>
        </div>
    </div>

    <!-- Overlay הודעת שגיאה -->
    <div id="error-overlay">
        <div class="error-box">
            <div class="text-5xl mb-4">✋</div>
            <h3 class="text-xl font-bold text-[#4D453E] mb-2">אופס!</h3>
            <p class="text-[#8A7F77] mb-6 font-medium">הקוד שהזנת שגוי.</p>
            <button id="close-error-btn" class="w-full bg-[#ef4444] text-white font-bold py-3 rounded-xl hover:bg-[#dc2626] transition-colors shadow-lg shadow-red-500/20">
                נסה שנית
            </button>
        </div>
    </div>

    <!-- תוכן האתר (מוסתר בהתחלה) -->
    <div id="app-content" style="display: none;">
        
        <!-- Header קומפקטי יותר -->
        <header class="text-center pt-8 pb-4 px-4">
            <h1 class="text-3xl md:text-5xl font-bold text-[#4D453E]">הטיול הארקטי שלנו</h1>
            <p class="text-lg text-[#8A7F77] mt-1">טרומסו | ינואר 2026</p>
        </header>

        <!-- Navigation - Sticky & Scrollable -->
        <div class="sticky top-0 z-40 bg-[#F5F0E6]/95 backdrop-blur-sm border-b border-[#D8CFC7] shadow-sm">
            <nav id="nav-container" class="flex overflow-x-auto no-scrollbar py-3 px-4 gap-6 md:justify-center items-center -mb-px">
                <button class="nav-link active text-lg pb-2" data-tab="main">ראשי</button>
                <button class="nav-link text-lg pb-2" data-tab="logistics">לוגיסטיקה</button>
                <button class="nav-link text-lg pb-2" data-tab="accommodation">לינה</button>
                <button class="nav-link text-lg pb-2" data-tab="activities">פעילויות</button>
                <button class="nav-link text-lg pb-2" data-tab="budget">תקציב</button>
                <button class="nav-link text-lg pb-2" data-tab="itinerary">מסלול</button>
                <button class="nav-link text-lg pb-2" data-tab="tips">ציוד</button>
            </nav>
            <!-- מחוון גלילה עדין (גרדיאנט) בצד שמאל לסימון שיש עוד תוכן -->
            <div class="absolute left-0 top-0 bottom-0 w-8 bg-gradient-to-r from-[#F5F0E6] to-transparent pointer-events-none md:hidden"></div>
        </div>

        <!-- Main Content Wrapper -->
        <main class="container mx-auto max-w-4xl p-4 pb-20">
            
            <!-- Tab 1: Main -->
            <section id="main" class="tab-content active">
                <div class="bg-white rounded-2xl shadow-sm border border-[#E5E0D8] p-5 md:p-8">
                    <h2 class="text-2xl font-bold mb-3 text-[#4D453E]">ברוכים הבאים 👋</h2>
                    <p class="text-base md:text-lg leading-relaxed mb-6 text-[#5C544D]">
                        כלי התכנון האינטראקטיבי לטיול החלומות. כאן מרוכז כל המידע לטיול עצמאי וחסכוני בטרומסו.
                    </p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-[#F9F7F5] rounded-xl p-4 border border-[#EBE6E0] flex items-center md:block text-center gap-4">
                            <span class="text-3xl block md:mb-2">📅</span>
                            <div class="text-right md:text-center">
                                <h3 class="font-bold text-[#4D453E]">תאריכים</h3>
                                <p class="text-sm text-[#8A7F77]">13-21 ינואר 2026</p>
                            </div>
                        </div>
                        <div class="bg-[#F9F7F5] rounded-xl p-4 border border-[#EBE6E0] flex items-center md:block text-center gap-4">
                            <span class="text-3xl block md:mb-2">💰</span>
                            <div class="text-right md:text-center">
                                <h3 class="font-bold text-[#4D453E]">תקציב</h3>
                                <p class="text-sm text-[#8A7F77]">~25k ש"ח לזוג</p>
                            </div>
                        </div>
                        <div class="bg-[#F9F7F5] rounded-xl p-4 border border-[#EBE6E0] flex items-center md:block text-center gap-4">
                            <span class="text-3xl block md:mb-2">🌌</span>
                            <div class="text-right md:text-center">
                                <h3 class="font-bold text-[#4D453E]">מטרה</h3>
                                <p class="text-sm text-[#8A7F77]">הזוהר הצפוני</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab 2: Logistics -->
            <section id="logistics" class="tab-content">
                <div class="bg-white rounded-2xl shadow-sm border border-[#E5E0D8] p-5 md:p-8">
                    <h2 class="text-2xl font-bold mb-4 text-[#4D453E]">לוגיסטיקה וטיסות</h2>
                    
                    <div class="space-y-6">
                        <div class="bg-blue-50/50 p-4 rounded-xl border border-blue-100">
                            <h3 class="font-bold text-[#4D453E] mb-2 flex items-center gap-2">🛫 הלוך: 13/01/26</h3>
                            <p class="text-sm md:text-base">נחיתה ב-AMS ב-10:20. <br><b>חובה:</b> טיסת המשך ל-TOS אחרי 13:30 (דרך OSL).</p>
                        </div>

                        <div class="bg-blue-50/50 p-4 rounded-xl border border-blue-100">
                            <h3 class="font-bold text-[#4D453E] mb-2 flex items-center gap-2">🛬 חזור: 20/01/26</h3>
                            <p class="text-sm md:text-base">הטיסה לישראל ב-21/1 בבוקר. <br><b>חובה:</b> לטוס ל-AMS ב-20/1 ולישון במלון בשדה.</p>
                        </div>

                        <div class="bg-orange-50/50 p-4 rounded-xl border border-orange-100">
                            <h3 class="font-bold text-[#4D453E] mb-2 flex items-center gap-2">🚗 רכב</h3>
                            <p class="text-sm md:text-base">חובה 4x4 (כמו RAV4). <br>הזמינו דרך Hertz/Avis ב-TOS.</p>
                        </div>
                    </div>

                    <h3 class="text-xl font-bold mt-8 mb-4">צ'ק ליסט לביצוע</h3>
                    <div class="space-y-3">
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer border border-transparent hover:border-[#D8CFC7]">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base md:text-lg select-none">הזמנת טיסות AMS ⇄ TOS</span>
                        </label>
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer border border-transparent hover:border-[#D8CFC7]">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base md:text-lg select-none">הזמנת מלון בשדה AMS</span>
                        </label>
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer border border-transparent hover:border-[#D8CFC7]">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base md:text-lg select-none">הזמנת רכב 4x4</span>
                        </label>
                    </div>
                </div>
            </section>

            <!-- Tab 3: Accommodation -->
            <section id="accommodation" class="tab-content">
                <div class="bg-white rounded-2xl shadow-sm border border-[#E5E0D8] p-5 md:p-8">
                    <h2 class="text-2xl font-bold mb-4 text-[#4D453E]">לינה ובקתות</h2>
                    <p class="text-sm md:text-base text-[#5C544D] mb-6">הסוד לחיסכון וזוהר: 2 לילות בעיר, 5 לילות בבקתה מרוחקת עם מטבח.</p>
                    
                    <div class="grid grid-cols-1 gap-4">
                        <div class="border border-[#E5E0D8] rounded-xl p-4">
                            <h4 class="font-bold text-lg text-[#4D453E] mb-1">📍 Kvaløya (אי הלווייתנים)</h4>
                            <p class="text-sm text-[#8A7F77]">30 דק' מהעיר, חשוך ומושלם לזוהר. <br>חפשו ב: <b>Ersfjordbotn, Sommarøy</b>.</p>
                        </div>
                        <div class="border border-[#E5E0D8] rounded-xl p-4">
                            <h4 class="font-bold text-lg text-[#4D453E] mb-1">📍 Senja</h4>
                            <p class="text-sm text-[#8A7F77]">שקט פראי ונוף דרמטי. 3 שעות נסיעה. מומלץ ל-2 לילות.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab 4: Activities -->
            <section id="activities" class="tab-content">
                <div class="bg-white rounded-2xl shadow-sm border border-[#E5E0D8] p-5 md:p-8">
                    <h2 class="text-2xl font-bold mb-4 text-[#4D453E]">מה עושים?</h2>
                    
                    <div class="space-y-4">
                        <div class="relative overflow-hidden rounded-xl bg-[#2D3748] text-white p-5">
                            <div class="relative z-10">
                                <h3 class="text-xl font-bold mb-2">🌌 ציד הזוהר (לבד!)</h3>
                                <ul class="text-sm space-y-2 text-gray-300">
                                    <li>• להוריד אפליקציית My Aurora + Yr.no</li>
                                    <li>• לנסוע לחוף חשוך ב-Kvaløya</li>
                                    <li>• להביא תרמוס וביגוד חם בטירוף</li>
                                    <li>• שעות שיא: 18:00 - 01:00</li>
                                </ul>
                            </div>
                        </div>

                        <h3 class="font-bold text-[#4D453E] mt-6">פעילויות בתשלום</h3>
                        <div class="flex gap-3 overflow-x-auto no-scrollbar pb-2">
                            <div class="min-w-[200px] bg-gray-50 p-4 rounded-xl border border-gray-100">
                                <span class="text-2xl block mb-2">🐕</span>
                                <h4 class="font-bold">מזחלות כלבים</h4>
                                <p class="text-xs text-gray-500">נהיגה עצמית, חוויה חובה.</p>
                            </div>
                            <div class="min-w-[200px] bg-gray-50 p-4 rounded-xl border border-gray-100">
                                <span class="text-2xl block mb-2">🚡</span>
                                <h4 class="font-bold">רכבל Fjellheisen</h4>
                                <p class="text-xs text-gray-500">תצפית על העיר (זול יחסית).</p>
                            </div>
                            <div class="min-w-[200px] bg-gray-50 p-4 rounded-xl border border-gray-100">
                                <span class="text-2xl block mb-2">🧖‍♂️</span>
                                <h4 class="font-bold">סאונת Pust</h4>
                                <p class="text-xs text-gray-500">סאונה צפה בנמל + טבילה בים.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab 5: Budget -->
            <section id="budget" class="tab-content">
                <div class="bg-white rounded-2xl shadow-sm border border-[#E5E0D8] p-5 md:p-8">
                    <h2 class="text-2xl font-bold mb-2 text-[#4D453E]">תקציב: 25,000 ש"ח</h2>
                    <p class="text-sm text-[#8A7F77] mb-6">יעד מאתגר אך אפשרי עם בישול עצמי.</p>
                    
                    <div class="chart-container">
                        <canvas id="budgetChart"></canvas>
                    </div>

                    <div class="mt-6 bg-[#F9F7F5] rounded-xl p-4">
                        <h3 class="font-bold mb-3 text-center">הערכה לזוג (ש"ח)</h3>
                        <div class="space-y-2 text-sm md:text-base">
                            <div class="flex justify-between border-b border-gray-200 pb-1"><span>טיסות</span> <span class="font-semibold">4,500</span></div>
                            <div class="flex justify-between border-b border-gray-200 pb-1"><span>לינה</span> <span class="font-semibold">7,200</span></div>
                            <div class="flex justify-between border-b border-gray-200 pb-1"><span>רכב ודלק</span> <span class="font-semibold">4,000</span></div>
                            <div class="flex justify-between border-b border-gray-200 pb-1"><span>פעילויות</span> <span class="font-semibold">4,000</span></div>
                            <div class="flex justify-between border-b border-gray-200 pb-1"><span>אוכל</span> <span class="font-semibold">2,800</span></div>
                            <div class="flex justify-between text-[#A2B8C4] pt-1"><span>מרווח ביטחון</span> <span>2,500</span></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab 6: Itinerary -->
            <section id="itinerary" class="tab-content">
                <div class="bg-white rounded-2xl shadow-sm border border-[#E5E0D8] p-5 md:p-8">
                    <h2 class="text-2xl font-bold mb-6 text-[#4D453E]">לו"ז (8 ימים)</h2>
                    
                    <div class="relative border-r-2 border-[#E5E0D8] mr-3 space-y-8">
                        <!-- פריט מסלול -->
                        <div class="relative pr-6">
                            <span class="absolute -right-[9px] top-0 w-4 h-4 rounded-full bg-[#A2B8C4] border-2 border-white ring-1 ring-[#E5E0D8]"></span>
                            <h3 class="font-bold text-[#4D453E]">13/1: נחיתה והתמקמות</h3>
                            <p class="text-sm text-[#5C544D] mt-1">רכב, סופר, נסיעה לבקתה וציד זוהר ראשון.</p>
                        </div>
                        <div class="relative pr-6">
                            <span class="absolute -right-[9px] top-0 w-4 h-4 rounded-full bg-[#A2B8C4] border-2 border-white ring-1 ring-[#E5E0D8]"></span>
                            <h3 class="font-bold text-[#4D453E]">14/1: העיר טרומסו</h3>
                            <p class="text-sm text-[#5C544D] mt-1">רכבל בבוקר (דמדומים), קתדרלה וסיבוב בעיר.</p>
                        </div>
                        <div class="relative pr-6">
                            <span class="absolute -right-[9px] top-0 w-4 h-4 rounded-full bg-[#A2B8C4] border-2 border-white ring-1 ring-[#E5E0D8]"></span>
                            <h3 class="font-bold text-[#4D453E]">15/1: האסקי וזוהר</h3>
                            <p class="text-sm text-[#5C544D] mt-1">מזחלות בוקר, שנ"צ וערב בחושך של Ersfjord.</p>
                        </div>
                        <div class="relative pr-6">
                            <span class="absolute -right-[9px] top-0 w-4 h-4 rounded-full bg-[#A2B8C4] border-2 border-white ring-1 ring-[#E5E0D8]"></span>
                            <h3 class="font-bold text-[#4D453E]">16/1: רוד טריפ</h3>
                            <p class="text-sm text-[#5C544D] mt-1">נסיעה ל-Sommarøy. חופים לבנים קפואים.</p>
                        </div>
                        <div class="relative pr-6">
                            <span class="absolute -right-[9px] top-0 w-4 h-4 rounded-full bg-[#4D453E] border-2 border-white ring-1 ring-[#E5E0D8]"></span>
                            <h3 class="font-bold text-[#4D453E]">20/1: טסים ל-AMS</h3>
                            <p class="text-sm text-[#5C544D] mt-1">החזרת רכב, טיסה לאמסטרדם, מלון בשדה.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab 7: Tips & Packing -->
            <section id="tips" class="tab-content">
                <div class="bg-white rounded-2xl shadow-sm border border-[#E5E0D8] p-5 md:p-8">
                    <h2 class="text-2xl font-bold mb-4 text-[#4D453E]">צידנית וציוד</h2>
                    
                    <div class="mb-6 bg-yellow-50/50 p-4 rounded-xl border border-yellow-100">
                        <h3 class="font-bold mb-2">🍽️ אוכל וחיסכון</h3>
                        <ul class="text-sm list-disc list-inside text-[#5C544D]">
                            <li>קניות רק ב-REMA 1000</li>
                            <li>לבשל: סלמון, קוד, פסטה</li>
                            <li>אלכוהול: יקר! לקנות בדיוטי פרי בארץ/AMS</li>
                        </ul>
                    </div>

                    <h3 class="font-bold mb-3">רשימת חובה (סמן V)</h3>
                    <div class="space-y-3">
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base select-none">2 סטים תרמיים (מרינו)</span>
                        </label>
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base select-none">מכנסי סקי / אטומים</span>
                        </label>
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base select-none">נעליים גבוהות אטומות</span>
                        </label>
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base select-none">חצובה למצלמה (חובה!)</span>
                        </label>
                        <label class="checklist-item flex items-center gap-x-4 p-3 bg-gray-50 rounded-xl cursor-pointer">
                            <input type="checkbox" class="w-6 h-6 rounded border-2 border-[#D8CFC7] text-[#4D453E] focus:ring-[#4D453E]">
                            <span class="text-base select-none">מטען נייד (הקור גומר סוללה)</span>
                        </label>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center text-sm text-[#8A7F77] py-6 px-4 mb-safe">
            <p>נוצר עבור הטיול שלנו ❤️</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- Login Logic (קוד כניסה) ---
            const loginScreen = document.getElementById('login-screen');
            const appContent = document.getElementById('app-content');
            const loginBtn = document.getElementById('login-btn');
            const passInput = document.getElementById('passcode-input');
            const errorOverlay = document.getElementById('error-overlay');
            const closeErrorBtn = document.getElementById('close-error-btn');
            const CORRECT_CODE = '8989';

            function checkPasscode() {
                if (passInput.value === CORRECT_CODE) {
                    passInput.blur(); // סגירת מקלדת במובייל
                    loginScreen.style.opacity = '0';
                    loginScreen.style.transition = 'opacity 0.4s ease';
                    setTimeout(() => {
                        loginScreen.style.display = 'none';
                        appContent.style.display = 'block';
                        window.scrollTo(0,0);
                        initChart(); 
                    }, 400);
                } else {
                    errorOverlay.style.display = 'flex';
                    passInput.value = ''; 
                    passInput.blur(); 
                }
            }

            function closeError() {
                errorOverlay.style.display = 'none';
                passInput.focus();
            }

            loginBtn.addEventListener('click', checkPasscode);
            closeErrorBtn.addEventListener('click', closeError);
            errorOverlay.addEventListener('click', (e) => {
                if (e.target === errorOverlay) closeError();
            });
            
            passInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkPasscode();
            });

            // --- Mobile Tab Navigation Logic ---
            const navLinks = document.querySelectorAll('.nav-link');
            const tabContents = document.querySelectorAll('.tab-content');
            const navContainer = document.getElementById('nav-container');

            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    const tabId = link.getAttribute('data-tab');

                    navLinks.forEach(nav => nav.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));

                    link.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                    
                    // גלילה אוטומטית של התפריט כדי שהכפתור הפעיל יהיה גלוי
                    link.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                    
                    // גלילה לראש התוכן
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            });

            // --- Checklist Logic ---
            const checklists = document.querySelectorAll('.checklist-item input[type="checkbox"]');
            checklists.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    // שמירת מצב ב-LocalStorage יכול להיות תוספת נחמדה כאן, אך לא חובה
                });
            });

            // --- Budget Chart ---
            function initChart() {
                const budgetCanvas = document.getElementById('budgetChart');
                if (budgetCanvas) {
                    const ctx = budgetCanvas.getContext('2d');
                    const budgetData = [7200, 4500, 4000, 4000, 2800, 2500];
                    const budgetLabels = ['לינה', 'טיסות', 'רכב', 'פעילויות', 'אוכל', 'ביטחון'];
                    
                    new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: budgetLabels,
                            datasets: [{
                                data: budgetData,
                                backgroundColor: ['#4D453E', '#8A7F77', '#A2B8C4', '#D8CFC7', '#BFAFA2', '#F5F0E6'],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            layout: { padding: 20 },
                            plugins: {
                                legend: { position: 'bottom', labels: { boxWidth: 12, padding: 15, font: { family: "'Assistant'", size: 14 } } },
                                tooltip: { 
                                    rtl: true,
                                    callbacks: { label: (c) => ' ' + c.parsed + ' ₪' }
                                }
                            }
                        }
                    });
                }
            }
        });
    </script>
</body>
</html>
